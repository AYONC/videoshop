
{{#partial "content"}}
    <a href="/"><< home</a>
    <h2>비디오 보기 - {{video.title}}</h2>
    <div>
        {{#if video.isOpened}}
            <button class="video-close-button">비디오 닫기</button>
        {{else}}
            <button class="video-open-button">비디오 열기</button>
        {{/if}}
    </div>
    <form method="POST">
        <input type="text" name="title" placeholder="title" value="{{video.title}}"/>
        <input type="text" name="description" placeholder="description" value="{{video.description}}"/>
        <span>오픈여부: {{video.isOpened}}</span>
        <button type="submit">실행</button>
    </form>
    <div>
        <h2>비디오가격보기</h2>
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>가격</th>
                <th>적용시작시간</th>
                <th>생성시간</th>
            </tr>
            </thead>
            <tbody>
            {{#each videoPrices}}
                <tr>
                    <td>{{id}}</td>
                    <td>{{price}}</td>
                    <td>{{startedAt}}</td>
                    <td>{{createdAt}}</td>
                </tr>
            {{/each}}
            </tbody>
        </table>
    </div>

    <script type="text/javascript">
        window.onload = function() {
            const openButton = document.querySelector(".video-open-button");
            if (openButton != null) {
                openButton.addEventListener('click', e => {
                    fetch("/videos/{{video.id}}/open/", {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        '{{_csrf.headerName}}': '{{_csrf.token}}'
                    },
                    credentials: 'include'
                })
                .then(resp => resp.json())
                .then(data => window.location.reload(true));
                });
            }

            const closeButton = document.querySelector(".video-close-button");
            if (closeButton != null) {
                closeButton.addEventListener('click', e => {
                    fetch("/videos/{{video.id}}/close/", {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        '{{_csrf.headerName}}': '{{_csrf.token}}'
                    },
                    credentials: 'include'
                })
                .then(resp => resp.json())
                .then(data => window.location.reload(true));
                });
            }
        };
    </script>
{{/partial}}

{{>member/include/base}}
